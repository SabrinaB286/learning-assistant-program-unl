<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Learning Assistant Feedback</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="data:," />
  <style>
    :root {
      --unl-red: #d00000;
      --bg: #f6f7fb;
      --ink: #111;
      --muted: #475569;
      --ring: #e5e7eb;
      --card: #fff;
      --chip: #e9eef7;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--ink);
    }

    .topbar {
      position: sticky;
      top: 0;
      z-index: 50;
      background: linear-gradient(135deg, var(--unl-red), #9c0000);
      color: #fff;
      padding: 16px 0;
      box-shadow: 0 2px 10px rgba(0, 0, 0, .08);
    }

    .shell {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 16px;
    }

    .brand {
      font-weight: 800;
      letter-spacing: .3px;
    }

    .sub {
      opacity: .85;
      font-size: .95rem;
    }

    .nav {
      display: flex;
      gap: 10px;
      margin: 14px 0 0 0;
    }

    .btn,
    .chip {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      background: #fff;
      border: 1px solid #fff;
      color: #c00;
      border-radius: 999px;
      padding: 8px 14px;
      cursor: pointer;
      text-decoration: none;
      font-weight: 600;
    }

    .btn:hover {
      filter: brightness(.95);
    }

    .btn-ghost {
      background: transparent;
      color: #fff;
      border-color: #fff;
    }

    .wrap {
      background: var(--card);
      border: 1px solid var(--ring);
      border-radius: 14px;
      padding: 18px;
      margin-top: 16px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, .06);
    }

    .grid {
      display: grid;
      gap: 14px;
    }

    .g-3 {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }

    .muted {
      color: var(--muted);
    }

    .h {
      font-size: 2rem;
      font-weight: 800;
      margin: 8px 0 6px;
    }

    .row {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .section {
      padding: 20px 0 32px;
    }

    .hidden {
      display: none !important;
    }

    .chip {
      background: var(--chip);
      color: #111;
      border-color: #e5e7eb;
    }

    .chip.active {
      background: #fff;
      color: var(--unl-red);
      border-color: #cbd5e1;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--ring);
      border-radius: 10px;
      background: #fff;
    }

    textarea {
      min-height: 110px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 10px;
      border-bottom: 1px solid var(--ring);
      text-align: left;
      font-size: .95rem
    }

    .btn-red {
      background: var(--unl-red);
      color: #fff;
      border-color: var(--unl-red);
    }

    .alert {
      padding: 12px 14px;
      border-radius: 10px;
      margin: 12px 0;
      font-weight: 600;
    }

    .alert-error {
      background: #ffefef;
      color: #9f1239;
      border: 1px solid #fecdd3;
    }

    .alert-ok {
      background: #ecfdf5;
      color: #065f46;
      border: 1px solid #a7f3d0;
    }

    .stars {
      display: inline-flex;
      flex-direction: row-reverse;
      gap: .25rem;
    }

    .stars input {
      display: none;
    }

    .stars label {
      font-size: 28px;
      cursor: pointer;
      color: #c7c7c7;
      line-height: 1;
      transition: filter .15s ease, transform .05s ease;
    }

    .stars label:hover,
    .stars label:hover~label {
      color: #ffbf00;
    }

    .stars input:checked~label {
      color: #ffbf00;
    }

    .stars label:active {
      transform: scale(.94);
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="shell">
      <div class="brand">Learning Assistant Feedback</div>
      <div class="sub">Computer Science &amp; Engineering – University of Nebraska–Lincoln</div>
      <nav class="nav" id="nav">
        <button class="btn" data-tab="feedback">Feedback</button>
        <button class="btn" data-tab="office">Office Hours</button>
        <button class="btn btn-ghost" data-tab="login" id="loginTab">Login</button>
        <button class="btn btn-ghost hidden" id="logoutBtn">Log out</button>
      </nav>
    </div>
  </header>

  <main class="shell">

    <!-- FEEDBACK (default visible) -->
    <section id="tab-feedback" class="section">
      <div class="wrap">
        <div class="h">Submit Feedback</div>
        <div class="muted">Share course or LA feedback. Submissions are stored in Supabase.</div>

        <form id="feedback-form" class="grid" style="margin-top:14px;">
          <div class="g-3">
            <div>
              <label>Course</label>
              <select name="course" required>
                <option value="">Select a course</option>
                <option>CSCE 101</option>
                <option>CSCE 155A</option>
                <option>CSCE 155E</option>
                <option>CSCE 155H</option>
                <option>CSCE 156</option>
              </select>
            </div>
            <div>
              <label>Type</label>
              <select name="type" required>
                <option value="Course">Course</option>
                <option value="TA">Staff / LA</option>
                <option value="Office Hours">Office hours</option>
                <option value="Website">Website</option>
                <option value="Random">Random</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div>
              <label>Year (optional)</label>
              <select name="year">
                <option value="">Prefer not to say</option>
                <option>Freshman</option>
                <option>Sophomore</option>
                <option>Junior</option>
                <option>Senior</option>
                <option>Graduate</option>
              </select>
            </div>
          </div>

          <div>
            <label>Rating</label>
            <div class="stars" id="stars">
              <input id="r5" type="radio" name="rating" value="5"><label for="r5">★</label>
              <input id="r4" type="radio" name="rating" value="4"><label for="r4">★</label>
              <input id="r3" type="radio" name="rating" value="3"><label for="r3">★</label>
              <input id="r2" type="radio" name="rating" value="2"><label for="r2">★</label>
              <input id="r1" type="radio" name="rating" value="1"><label for="r1">★</label>
            </div>
          </div>

          <div>
            <label>Feedback</label>
            <textarea name="text" placeholder="Your feedback…" required></textarea>
          </div>

          <div class="g-3">
            <div>
              <label>Your name (optional)</label>
              <input name="submitter" placeholder="Jane Doe" />
            </div>
            <div>
              <label>NUID (optional)</label>
              <input name="id_entered" placeholder="12345678" />
            </div>
          </div>

          <div class="row" style="justify-content:flex-end;">
            <button class="btn btn-red" type="submit">Submit</button>
          </div>

          <div id="fb-alert" class="alert hidden"></div>
        </form>
      </div>
    </section>

    <!-- OFFICE HOURS -->
    <section id="tab-office" class="section hidden">
      <div class="wrap">
        <div class="h">Office Hours</div>
        <div class="muted">Browse office hours by course. Data comes from staff schedules.</div>
        <div id="oh-chips" class="row" style="margin-top:10px;"></div>
        <div id="oh-list" style="margin-top:10px;"></div>
      </div>
    </section>

    <!-- LOGIN (your existing /routes/auth.js handles the logic) -->
    <section id="tab-login" class="section hidden">
      <div class="wrap">
        <div class="h">Sign in</div>
        <div id="login-mount"></div>
      </div>
    </section>

    <!-- STAFF (optional dedicated tab if you want it visible only for staff; 
         your /routes/staff.js can hide/show based on role) -->
    <section id="tab-staff" class="section hidden">
      <div class="wrap">
        <div class="h">My Schedule</div>
        <form id="sched-form" class="grid g-3">
          <div>
            <label>Course</label>
            <select name="course" required>
              <option value="">Select course</option>
              <option>CSCE 101</option>
              <option>CSCE 155A</option>
              <option>CSCE 155E</option>
              <option>CSCE 155H</option>
              <option>CSCE 156</option>
            </select>
          </div>
          <div>
            <label>Type</label>
            <select name="type" required>
              <option value="office_hour">Office hour</option>
              <option value="lab_time">Lab time</option>
            </select>
          </div>
          <div>
            <label>Day of week</label>
            <select name="dow" required>
              <option value="0">Sunday</option>
              <option value="1">Monday</option>
              <option value="2">Tuesday</option>
              <option value="3">Wednesday</option>
              <option value="4">Thursday</option>
              <option value="5">Friday</option>
              <option value="6">Saturday</option>
            </select>
          </div>
          <div>
            <label>Start</label>
            <input type="time" name="start" required>
          </div>
          <div>
            <label>End</label>
            <input type="time" name="end" required>
          </div>
          <div>
            <label>Location</label>
            <input name="location" placeholder="Avery 19">
          </div>
          <div class="row" style="grid-column:1/-1; justify-content:flex-end;">
            <button class="btn btn-red" type="submit">Save</button>
          </div>
        </form>

        <div class="wrap" style="margin-top:14px;">
          <table>
            <thead>
              <tr>
                <th>Course</th>
                <th>Type</th>
                <th>Day</th>
                <th>Time</th>
                <th>Location</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="sched-rows"></tbody>
          </table>
        </div>
      </div>
    </section>

  </main>

  <!-- Client libraries -->
  <script src="/lib/supabase.js"></script>
  <script type="module" src="/public/config.js"></script>
  <!-- Your existing auth UI/logic (unchanged) -->
  <script type="module" src="/auth.js"></script>

  <!-- Feature modules -->
  <script type="module" src="/feedback/feedback.js"></script>
  <script type="module" src="/routes/office-hours.js"></script>
  <script type="module" src="/routes/staff.js"></script>

  <script>
    // Simple tab switcher (default: feedback)
    const tabs = ['feedback', 'office', 'login', 'staff'];
    function showTab(name) {
      tabs.forEach(t => {
        document.getElementById('tab-' + t)?.classList.toggle('hidden', t !== name);
      });
    }
    document.getElementById('nav').addEventListener('click', (e) => {
      const t = e.target.dataset.tab; if (!t) return;
      showTab(t);
    });
    showTab('feedback'); // default
  </script>
</body>

</html>